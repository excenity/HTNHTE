df$ADI_NATRANK = df$ADI_NATRANK/10
df$distance = df$distance_meters/16093.44
# model1 = glm(telemed_flag ~ age + race, data = df, family = 'binomial' )
# summary(model1)
# exp(coef(model1))
# exp(confint(model1))
# model2 = glm(telemed_flag ~ age + insurance, data = df, family = 'binomial' )
# summary(model2)
# round(exp(coef(model2)),3)
# round(exp(confint(model2)),3)
# model3 = glm(telemed_flag ~ age + race + insurance , data = df, family = 'binomial' )
# summary(model3)
# round(exp(coef(model3)), 3)
# final_coef = round(exp(coef(model3)), 3)
# exp(confint(model3))
# knitr::kable(final_coef)
df$ADI_NATRANK[is.na(df$ADI_NATRANK)] = median(df$ADI_NATRANK, na.rm = T)
df[,c('ADI_NATRANK', 'in_system_days', 'distance')] = sapply(df[,c('ADI_NATRANK', 'in_system_days', 'distance')], function(x) scale(x, scale=FALSE))
model4 = glm(telemed_flag ~ age + gender + race + insurance + ADI_NATRANK + in_system_days + distance, data = df, family = 'binomial')
# summary(model4)
# coefs_model4 = exp(coef(model4))
# coefs_model4['in_system_days'] = coefs_model4['in_system_days']
# coefs_model4['distance'] = coefs_model4['distance']
# knitr::kable(round(coefs_model4,3))
# model4_cs = glm(telemed_flag ~ age + gender + race + insurance + ADI_NATRANK + in_system_days + distance + cancer_stage, data = df %>% filter(!is.na(cancer_stage)), family = 'binomial')
# summary(model4_cs)
# coefs_model4_cs = exp(coef(model4_cs))
# knitr::kable(round(coefs_model4_cs,3))
model5.1 = glm(telemed_flag ~ age + gender + race*insurance + ADI_NATRANK + in_system_days + distance, data = df, family = 'binomial')
anova(model5.1, model4, test = 'Chisq')
model5.2 = glm(telemed_flag ~ age + gender + insurance + race*ADI_NATRANK + in_system_days + distance, data = df, family = 'binomial')
anova(model5.2, model4, test = 'Chisq')
model5.3 = glm(telemed_flag ~ age + gender + insurance + ADI_NATRANK + race*in_system_days + distance, data = df, family = 'binomial')
anova(model5.3, model4, test = 'Chisq')
model5.4 = glm(telemed_flag ~ age + gender + insurance + ADI_NATRANK + in_system_days + race*distance, data = df, family = 'binomial')
anova(model5.4, model4, test = 'Chisq')
model5 = glm(telemed_flag ~ age + gender + race*(insurance + ADI_NATRANK + in_system_days + distance), data = df, family = 'binomial')
summary(model5)
coefs_model5 = as.data.frame(sprintf('%.2f', round(exp(coef(model5)),3)))
coefs_model5$var_names = row.names(as.data.frame(model5$coefficients))
row.names(coefs_model5) = 1:nrow(coefs_model5)
ci_model5 = exp(confint(model5))
ci_model5 = as.data.frame((ci_model5))
ci_model5$`2.5 %` = sprintf('%.2f', round(ci_model5$`2.5 %`, 3))
ci_model5$`97.5 %` = sprintf('%.2f', round(ci_model5$`97.5 %`, 3))
coefs_model5 = cbind(coefs_model5, ci_model5)
names(coefs_model5) = c('OR', 'Vars', 'CI_Lower', 'CI_Upper')
coefs_model5 = coefs_model5 %>% dplyr::select(Vars, OR, CI_Lower, CI_Upper)
knitr::kable(coefs_model5, align = c('l', 'c', 'c', 'c'))
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'age', 'Age')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'genderM', 'Male')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceBlack or African American', 'African American')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceHispanic', 'Hispanic')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceAsian', 'Asian')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceMedicare', 'Medicare')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceMedicaid', 'Medicaid')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceSelf-Pay', 'Self-Pay')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'ADI_NATRANK', 'ADI (/Decile)')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'in_system_days', 'Years In System')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'distance', 'Distance to Clinic (/10 Miles)')
coefs_model5$Vars = str_replace(coefs_model5$Vars, ':', ' : ')
coefs_model5
tabletext = cbind(c("Variable", as.character(coefs_model5_forestplot$Vars)),
c("OR", as.character(coefs_model5_forestplot$OR)),
c("95% CI", paste(as.character(coefs_model5_forestplot$CI_Lower), '-', as.character(coefs_model5_forestplot$CI_Upper))))
coefs_model5_forestplot = coefs_model5[2:30, ]
tabletext = cbind(c("Variable", as.character(coefs_model5_forestplot$Vars)),
c("OR", as.character(coefs_model5_forestplot$OR)),
c("95% CI", paste(as.character(coefs_model5_forestplot$CI_Lower), '-', as.character(coefs_model5_forestplot$CI_Upper))))
coefs_model5_forestplot = coefs_model5_forestplot %>% dplyr::select(-Vars)
coefs_model5_forestplot = rbind(c(NA, NA, NA), coefs_model5_forestplot)
names(coefs_model5_forestplot) = c('mean', 'lower', 'upper')
coefs_model5_forestplot$mean = as.numeric(coefs_model5_forestplot$mean)
coefs_model5_forestplot$lower = as.numeric(coefs_model5_forestplot$lower)
coefs_model5_forestplot$upper = as.numeric(coefs_model5_forestplot$upper)
o
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, 29)),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemed <-- --> More Likely to Use Telemed')
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, 29)),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine')
View(coefs_model5_forestplot)
View(coefs_model5)
tabletext
View(coefs_model5_forestplot)
View(coefs_model5)
# add additional rows for headers
coefs_model5 = coefs_model5 %>% add_row(Vars = 'Female', before = 3)
# add additional rows for headers
coefs_model5 = coefs_model5 %>% add_row(Vars = 'Female', .before = 3)
coefs_model5 = cbind(coefs_model5, ci_model5)
coefs_model5 = as.data.frame(sprintf('%.2f', round(exp(coef(model5)),3)))
coefs_model5$var_names = row.names(as.data.frame(model5$coefficients))
row.names(coefs_model5) = 1:nrow(coefs_model5)
coefs_model5 = cbind(coefs_model5, ci_model5)
names(coefs_model5) = c('OR', 'Vars', 'CI_Lower', 'CI_Upper')
coefs_model5 = coefs_model5 %>% dplyr::select(Vars, OR, CI_Lower, CI_Upper)
knitr::kable(coefs_model5, align = c('l', 'c', 'c', 'c'))
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'age', 'Age')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'genderM', 'Male')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceBlack or African American', 'African American')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceHispanic', 'Hispanic')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceAsian', 'Asian')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceMedicare', 'Medicare')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceMedicaid', 'Medicaid')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceSelf-Pay', 'Self-Pay')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'ADI_NATRANK', 'ADI (/Decile)')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'in_system_days', 'Years In System')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'distance', 'Distance to Clinic (/10 Miles)')
coefs_model5$Vars = str_replace(coefs_model5$Vars, ':', ' : ')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'age', 'Age')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'genderM', 'Male')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceBlack or African American', 'African American')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceHispanic', 'Hispanic')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'raceAsian', 'Asian')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceMedicare', 'Medicare')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceMedicaid', 'Medicaid')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'insuranceSelf-Pay', 'Self-Pay')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'ADI_NATRANK', 'ADI (/Decile)')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'in_system_days', 'Years In System')
coefs_model5$Vars = str_replace(coefs_model5$Vars, 'distance', 'Distance to Clinic (/10 Miles)')
coefs_model5$Vars = str_replace(coefs_model5$Vars, ':', ' : ')
View(coefs_model5)
head(df)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 4) %>% add_row(Vars = 'Private', .before = 12) %>% add_row(Vars = 'White : Medicare', .before = 13) %>% add_row(Vars = 'White : Medicaid', .before = 16) %>% add_row(Vars = 'White : Self-Pay', .before = 19) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 22) %>% add_row(Vars = 'White : Years In System', .before = 25) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 28)
View(coefs_model5)
View(coefs_model5_fp)
?|>
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 14) %>% add_row(Vars = 'White : Medicare', .before = 17) %>% add_row(Vars = 'White : Medicaid', .before = 20) %>% add_row(Vars = 'White : Self-Pay', .before = 24) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 28) %>% add_row(Vars = 'White : Years In System', .before = 32) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 36)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 14) %>% add_row(Vars = 'White : Medicare', .before = 17) %>% add_row(Vars = 'White : Medicaid', .before = 20) %>% add_row(Vars = 'White : Self-Pay', .before = 24) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 28) %>% add_row(Vars = 'White : Years In System', .before = 32) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 36)
View(coefs_model5_fp)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 9) %>% add_row(Vars = 'White : Medicare', .before = 17) %>% add_row(Vars = 'White : Medicaid', .before = 20) %>% add_row(Vars = 'White : Self-Pay', .before = 24) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 28) %>% add_row(Vars = 'White : Years In System', .before = 32) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 36)
View(coefs_model5_fp)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 9) %>% add_row(Vars = 'White : Medicare', .before = 16) %>% add_row(Vars = 'White : Medicaid', .before = 19) %>% add_row(Vars = 'White : Self-Pay', .before = 23) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 27) %>% add_row(Vars = 'White : Years In System', .before = 31) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 35)
coefs_model5_fp = coefs_model5_fp[2:nrow(coefs_model5_fp), ]
tabletext = cbind(c("Variable", as.character(coefs_model5_forestplot$Vars)),
c("OR", as.character(coefs_model5_forestplot$OR)),
c("95% CI", paste(as.character(coefs_model5_forestplot$CI_Lower), '-', as.character(coefs_model5_forestplot$CI_Upper))))
View(tabletext)
tabletext = cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper))))
View(tabletext)
tabletext$V3[is.na(tabletext$V2)] = 'Reference'
tabletext$V2[is.na(tabletext$V2)] = '1.00'
tabletext$V2[is.na(tabletext$V2),] = '1.00'
tabletext[is.na(tabletext$V2), V2] = '1.00'
tabletext[is.na(tabletext$V2), V3] = 'Reference'
View(tabletext)
tabletext = as.data.frame(cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper)))))
tabletext[is.na(tabletext$V2), V2] = '1.00'
View(tabletext)
tabletext[is.na(tabletext$V2), 'V2'] = '1.00'
tabletext[is.na(tabletext$V2), 'V3'] = 'Reference'
View(tabletext)
tabletext = as.data.frame(cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper)))))
tabletext[is.na(tabletext$V2), 'V3'] = 'Reference'
tabletext[is.na(tabletext$V2), 'V2'] = '1.00'
View(tabletext)
coefs_model5_forestplot = coefs_model5_fp %>% dplyr::select(-Vars)
coefs_model5_forestplot = rbind(c(NA, NA, NA), coefs_model5_forestplot)
names(coefs_model5_forestplot) = c('mean', 'lower', 'upper')
coefs_model5_forestplot$mean = as.numeric(coefs_model5_forestplot$mean)
coefs_model5_forestplot$lower = as.numeric(coefs_model5_forestplot$lower)
coefs_model5_forestplot$upper = as.numeric(coefs_model5_forestplot$upper)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, 29)),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header()
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, 29)),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine')
View(coefs_model5_forestplot)
coefs_model5_forestplot[is.na(coefs_model5_forestplot)] = 1
View(coefs_model5_forestplot)
coefs_model5_forestplot[is.na(coefs_model5_forestplot)] = 1
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, 29)),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine')
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine')
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine')
?fp_add_header
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F)
View(coefs_model5_fp)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 9) %>% add_row(Vars = 'White : Medicare', .before = 16) %>% add_row(Vars = 'White : Medicaid', .before = 19) %>% add_row(Vars = 'White : Self-Pay', .before = 23) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 27) %>% add_row(Vars = 'White : Years In System', .before = 31) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 35)
coefs_model5_fp = coefs_model5_fp[2:nrow(coefs_model5_fp), ]
tabletext = as.data.frame(cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper)))))
tabletext[is.na(tabletext$V2), 'V3'] = 'Reference'
tabletext[is.na(tabletext$V2), 'V2'] = '1.00'
coefs_model5_forestplot = coefs_model5_fp %>% dplyr::select(-Vars)
coefs_model5_forestplot = rbind(c(NA, NA, NA), coefs_model5_forestplot)
names(coefs_model5_forestplot) = c('mean', 'lower', 'upper')
coefs_model5_forestplot$mean = as.numeric(coefs_model5_forestplot$mean)
coefs_model5_forestplot$lower = as.numeric(coefs_model5_forestplot$lower)
coefs_model5_forestplot$upper = as.numeric(coefs_model5_forestplot$upper)
coefs_model5_forestplot[is.na(coefs_model5_forestplot)] = 1
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 42, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 42, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 42, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 42, is.summary = F)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 9) %>% add_row(Vars = 'White : Medicare', .before = 16) %>% add_row(Vars = 'White : Medicaid', .before = 19) %>% add_row(Vars = 'White : Self-Pay', .before = 23) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 28) %>% add_row(Vars = 'White : Years In System', .before = 32) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 36)
coefs_model5_fp = coefs_model5_fp[2:nrow(coefs_model5_fp), ]
tabletext = as.data.frame(cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper)))))
tabletext[is.na(tabletext$V2), 'V3'] = 'Reference'
tabletext[is.na(tabletext$V2), 'V2'] = '1.00'
coefs_model5_forestplot = coefs_model5_fp %>% dplyr::select(-Vars)
coefs_model5_forestplot = rbind(c(NA, NA, NA), coefs_model5_forestplot)
names(coefs_model5_forestplot) = c('mean', 'lower', 'upper')
coefs_model5_forestplot$mean = as.numeric(coefs_model5_forestplot$mean)
coefs_model5_forestplot$lower = as.numeric(coefs_model5_forestplot$lower)
coefs_model5_forestplot$upper = as.numeric(coefs_model5_forestplot$upper)
coefs_model5_forestplot[is.na(coefs_model5_forestplot)] = 1
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 42, is.summary = F)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 9) %>% add_row(Vars = 'White : Medicare', .before = 16) %>% add_row(Vars = 'White : Medicaid', .before = 19) %>% add_row(Vars = 'White : Self-Pay', .before = 23) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 28) %>% add_row(Vars = 'White : Years In System', .before = 32) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 36)
coefs_model5_fp = coefs_model5_fp[2:nrow(coefs_model5_fp), ]
tabletext = as.data.frame(cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper)))))
tabletext[is.na(tabletext$V2), 'V3'] = 'Reference'
tabletext[is.na(tabletext$V2), 'V2'] = '1.00'
coefs_model5_forestplot = coefs_model5_fp %>% dplyr::select(-Vars)
coefs_model5_forestplot = rbind(c(NA, NA, NA), coefs_model5_forestplot)
names(coefs_model5_forestplot) = c('mean', 'lower', 'upper')
coefs_model5_forestplot$mean = as.numeric(coefs_model5_forestplot$mean)
coefs_model5_forestplot$lower = as.numeric(coefs_model5_forestplot$lower)
coefs_model5_forestplot$upper = as.numeric(coefs_model5_forestplot$upper)
coefs_model5_forestplot[is.na(coefs_model5_forestplot)] = 1
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
# add additional rows for headers
coefs_model5_fp = coefs_model5 %>% add_row(Vars = 'Female', .before = 3) %>% add_row(Vars = 'White', .before = 5) %>% add_row(Vars = 'Private', .before = 9) %>% add_row(Vars = 'White : Medicare', .before = 16) %>% add_row(Vars = 'White : Medicaid', .before = 20) %>% add_row(Vars = 'White : Self-Pay', .before = 24) %>% add_row(Vars = 'White : ADI (/Decile)', .before = 28) %>% add_row(Vars = 'White : Years In System', .before = 32) %>% add_row(Vars = 'White : Distance to Clinic (/10 Miles)', .before = 36)
coefs_model5_fp = coefs_model5_fp[2:nrow(coefs_model5_fp), ]
tabletext = as.data.frame(cbind(c("Variable", as.character(coefs_model5_fp$Vars)),
c("OR", as.character(coefs_model5_fp$OR)),
c("95% CI", paste(as.character(coefs_model5_fp$CI_Lower), '-', as.character(coefs_model5_fp$CI_Upper)))))
tabletext[is.na(tabletext$V2), 'V3'] = 'Reference'
tabletext[is.na(tabletext$V2), 'V2'] = '1.00'
coefs_model5_forestplot = coefs_model5_fp %>% dplyr::select(-Vars)
coefs_model5_forestplot = rbind(c(NA, NA, NA), coefs_model5_forestplot)
names(coefs_model5_forestplot) = c('mean', 'lower', 'upper')
coefs_model5_forestplot$mean = as.numeric(coefs_model5_forestplot$mean)
coefs_model5_forestplot$lower = as.numeric(coefs_model5_forestplot$lower)
coefs_model5_forestplot$upper = as.numeric(coefs_model5_forestplot$upper)
coefs_model5_forestplot[is.na(coefs_model5_forestplot)] = 1
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
lineheight = 1.2,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
line.margin = 1.2,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
line.margin = 2,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
lineheight = 2,
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
lineheight = unit(2, 'cm'),
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
line.margin = unit(2, 'cm'),
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
line.margin = unit(2, 'cm'),
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
```{r, fig.height = 12, fig.width = 12}
coefs_model5_forestplot %>% forestplot(labeltext = tabletext,
is.summary = c(T, rep(F, nrow(coefs_model5_forestplot))),
zero = 1,
cex = 2,
lineheight = 'auto',
lty.ci = 'solid',
hrzl_lines = gpar(col = "#444444"),
boxsize = 0.15,
xlog = T,
line.margin = unit(2, 'cm'),
xlab = 'Less Likely to Use Telemedicine <-- --> More Likely to Use Telemedicine') |>
fp_add_header("Gender" |> fp_txt_bold(), position = 3, is.summary = F) |> fp_add_header("Race/Ethnicity" |> fp_txt_bold(), position = 6, is.summary = F) |> fp_add_header("Insurance Type" |> fp_txt_bold(), position = 11, is.summary = F) |> fp_add_header("Other Covariates" |> fp_txt_bold(), position = 16, is.summary = F) |> fp_add_header("Race/Ethnicity * Insurance Interaction" |> fp_txt_bold(), position = 20, is.summary = F) |> fp_add_header("Race/Ethnicity * ADI Interaction" |> fp_txt_bold(), position = 33, is.summary = F) |> fp_add_header("Race/Ethnicity * Years In System Interaction" |> fp_txt_bold(), position = 38, is.summary = F) |> fp_add_header("Race/Ethnicity * Distance to Clinic Interaction" |> fp_txt_bold(), position = 43, is.summary = F)
